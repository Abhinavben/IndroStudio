<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loading Website...</title>
    <style>
        /* पेज को बीच में लाने का स्टाइल */
        body { 
            background: #f3f4f6; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            height: 100vh; 
            font-family: sans-serif; 
            margin: 0; 
        }
        
        .container { 
            text-align: center; 
            width: 100%;
        }

        /* लोडर फिक्स: margin: 0 auto इसे बीच में लाएगा */
        .loader { 
            border: 4px solid #e5e7eb; 
            border-top: 4px solid #2563eb; 
            border-radius: 50%; 
            width: 40px; 
            height: 40px; 
            animation: spin 1s linear infinite; 
            margin: 0 auto; 
        }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        p { 
            margin-top: 15px; 
            color: #666; 
            font-weight: 500; 
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="loader"></div>
        <p>Opening Website...</p>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyC07JemT3VQQoDSOpARelJkcsqaWEO0vDI",
            authDomain: "indronetwork.firebaseapp.com",
            projectId: "indronetwork",
            storageBucket: "indronetwork.firebasestorage.app",
            messagingSenderId: "410515803868",
            appId: "1:410515803868:web:6c16375390301a34686e19"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function loadSite() {
            const params = new URLSearchParams(window.location.search);
            const id = params.get('id');

            if (!id) {
                document.body.innerHTML = "<h3 style='color:red; text-align:center;'>Error: Link Invalid (No ID)</h3>";
                return;
            }

            try {
                const docRef = doc(db, "clients", id);
                const docSnap = await getDoc(docRef);

                if (docSnap.exists()) {
                    const d = docSnap.data();
                    renderSite(d);
                } else {
                    document.body.innerHTML = "<h3 style='color:red; text-align:center;'>Website Not Found or Deleted</h3>";
                }
            } catch (error) {
                console.error("Error:", error);
                document.body.innerHTML = "<h3 style='color:red; text-align:center;'>Server Error. Try again later.</h3>";
            }
        }

        function renderSite(d) {
            let socialHTML = "";
            if(d.insta) socialHTML += `<a href="${d.insta}" target="_blank"><i class="fa-brands fa-instagram"></i> Instagram</a>`;
            if(d.fb) socialHTML += `<a href="${d.fb}" target="_blank"><i class="fa-brands fa-facebook"></i> Facebook</a>`;
            if(socialHTML === "") socialHTML = `<span style="opacity:0.5; font-size:12px;">No social links added.</span>`;

            let gallerySection = "";
            if(d.img1 || d.img2 || d.img3) {
                let imagesHTML = "";
                if(d.img1) imagesHTML += `<img src="${d.img1}" class="gallery-img">`;
                if(d.img2) imagesHTML += `<img src="${d.img2}" class="gallery-img">`;
                if(d.img3) imagesHTML += `<img src="${d.img3}" class="gallery-img">`;
                gallerySection = `<section class="sec"><div class="head"><h2>Our Gallery</h2><p>A glimpse of our work.</p></div><div class="gallery-grid">${imagesHTML}</div></section>`;
            }

            // FULL SITE TEMPLATE
            const siteHTML = `
            <!DOCTYPE html>
            <html lang="en">
            <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>${d.name}</title>
            <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700;900&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
            <style>
                :root { --p: #111; --acc: #4f46e5; --bg: #fff; --txt: #333; }
                * { margin:0; padding:0; box-sizing:border-box; font-family:'Outfit', sans-serif; scroll-behavior:smooth; }
                body { overflow-x:hidden; color:var(--txt); display:flex; flex-direction:column; min-height:100vh; background:white; } 
                header { padding:20px 5%; display:flex; justify-content:space-between; align-items:center; position:fixed; width:100%; top:0; z-index:999; background:rgba(255,255,255,0.95); backdrop-filter:blur(10px); border-bottom:1px solid #eee; }
                .logo { font-family:'Space Grotesk'; font-weight:800; font-size:24px; text-transform:uppercase; }
                .nav a { margin-left:25px; text-decoration:none; color:#555; font-weight:600; font-size:14px; }
                .hero { min-height:90vh; position:relative; display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center; padding:20px; color:white; background:#000; overflow:hidden; }
                .hero canvas { position:absolute; top:0; left:0; opacity:0.5; }
                .btn { padding:18px 45px; background:var(--acc); color:white; border-radius:50px; font-weight:700; text-decoration:none; transition:0.3s; border:none; cursor:pointer; z-index:2; display:inline-block; }
                .sec { padding:80px 5%; }
                .head { text-align:center; margin-bottom:50px; } .head h2 { font-size:2.8rem; font-weight:800; font-family:'Space Grotesk'; margin-bottom:10px; }
                .about-box { display:grid; grid-template-columns:1fr 1fr; gap:50px; align-items:center; }
                .about-img { width:100%; height:350px; background:#f0f0f0; border-radius:20px; object-fit:cover; }
                .grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(300px, 1fr)); gap:30px; }
                .card { background:white; padding:40px; border-radius:20px; border:1px solid #eee; box-shadow:0 10px 40px rgba(0,0,0,0.05); transition:0.3s; }
                .card:hover { transform:translateY(-5px); border-color:var(--acc); }
                .card i { font-size:35px; color:var(--acc); margin-bottom:20px; }
                
                /* ADS & APP SLOTS STYLE */
                #indro-ad-slot { display:none; margin:60px 5%; padding:30px; border-radius:20px; text-align:center; font-weight:700; cursor:pointer; border:1px solid #eee; background:#fdfdfd; box-shadow:0 10px 30px rgba(0,0,0,0.03); }
                #indro-app-slot { margin:60px 5%; padding:30px; border-radius:20px; display:none; border:1px dashed #e5e7eb; background:#f9fafb; }
                
                .process-grid { display:grid; grid-template-columns:repeat(4, 1fr); gap:20px; text-align:center; position:relative; }
                .process-step { background:#fff; padding:30px 10px; border-radius:15px; border:1px solid #eee; }
                .process-num { width:40px; height:40px; background:var(--acc); color:white; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:bold; margin:0 auto 15px auto; }
                .stats-grid { display:grid; grid-template-columns:repeat(4, 1fr); gap:20px; text-align:center; margin-top:30px; }
                .stat h3 { font-size:2.5rem; color:var(--acc); font-weight:900; }
                .testi-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(300px, 1fr)); gap:30px; }
                .testi-card { background:#f9fafb; padding:30px; border-radius:20px; border:1px solid #eee; }
                .gallery-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(250px, 1fr)); gap:15px; margin-top:30px; }
                .gallery-img { width:100%; height:250px; object-fit:cover; border-radius:12px; transition:0.3s; }
                .contact-sec { background:#111; color:white; border-radius:30px; margin:50px 5%; padding:60px; text-align:center; }
                .form-box input, .form-box textarea { width:100%; padding:15px; margin-bottom:15px; border-radius:10px; border:none; }
                .form-btn { width:100%; padding:15px; background:white; color:#111; font-weight:800; border:none; border-radius:10px; cursor:pointer; }
                .faq-item { border-bottom:1px solid #eee; padding:20px 0; cursor:pointer; }
                .faq-q { font-weight:700; display:flex; justify-content:space-between; font-size:18px; }
                .faq-a { display:none; margin-top:15px; color:#666; } .faq-item.active .faq-a { display:block; }
                #chat-root { position:fixed; bottom:25px; right:25px; z-index:9999; }
                .chat-bubble { width:60px; height:60px; background:var(--acc); border-radius:50%; display:flex; align-items:center; justify-content:center; color:white; font-size:26px; cursor:pointer; box-shadow:0 15px 40px rgba(0,0,0,0.2); transition:0.3s; animation: pulse 2s infinite; }
                @keyframes pulse { 0% {box-shadow: 0 0 0 0 rgba(79, 70, 229, 0.7);} 70% {box-shadow: 0 0 0 15px rgba(79, 70, 229, 0);} 100% {box-shadow: 0 0 0 0 rgba(79, 70, 229, 0);} }
                .chat-win { position:absolute; bottom:80px; right:0; width:340px; height:480px; background:white; border-radius:20px; box-shadow:0 20px 60px rgba(0,0,0,0.2); display:none; flex-direction:column; overflow:hidden; border:1px solid #eee; }
                .cw-head { padding:15px; background:var(--acc); color:white; font-weight:700; display:flex; justify-content:space-between; align-items:center; }
                .cw-body { flex:1; padding:15px; overflow-y:auto; background:#f9fafb; display:flex; flex-direction:column; gap:10px; font-size:13px; }
                .msg { padding:10px 15px; border-radius:12px; max-width:85%; }
                .ai { background:white; border:1px solid #eee; align-self:flex-start; }
                .user { background:var(--acc); color:white; align-self:flex-end; }
                .cw-in { padding:10px; background:white; border-top:1px solid #eee; display:flex; gap:10px; }
                .cw-in input { flex:1; border:1px solid #eee; padding:8px 15px; border-radius:20px; outline:none; }
                footer { background:#050505; color:#888; padding:60px 5% 30px 5%; font-size:14px; margin-top:auto; }
                .footer-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:40px; margin-bottom:40px; }
                footer h4 { color:white; margin-bottom:20px; font-size:16px; font-weight:700; }
                footer a { display:block; color:#888; margin-bottom:12px; text-decoration:none; transition:0.3s; display:flex; align-items:center; gap:8px; }
                footer a:hover { color:var(--acc); padding-left:5px; }
                @media(max-width:768px) { .hero h1 { font-size:3rem; } .about-box, .stats-grid, .process-grid, .gallery-grid { grid-template-columns:1fr; } .nav { display:none; } }
            </style>
            </head>
            <body>
            <header>
                <div class="logo">${d.name}</div>
                <nav class="nav"><a href="#about">About</a><a href="#services">Services</a><a href="#faq">FAQ</a><a href="#contact">Contact</a></nav>
            </header>
            <section class="hero" id="hero">
                <canvas id="particles"></canvas>
                <h1 style="position:relative; z-index:2;">${d.name}</h1>
                <p style="position:relative; z-index:2; max-width:600px; margin:0 auto 30px auto; opacity:0.8; font-size:1.2rem;">${d.desc}</p>
                <a href="#contact" class="btn">Get Started</a>
            </section>
            
            <div id="indro-ad-slot"></div>
            
            <section id="about" class="sec">
                <div class="about-box">
                    <div>
                        <h2 style="font-family:'Space Grotesk'; font-size:2.5rem; margin-bottom:20px;">Who We Are</h2>
                        <p style="color:#666; line-height:1.7; margin-bottom:20px;">We are a dedicated team based in ${d.loc}, committed to providing the best quality services to our customers.</p>
                        <div style="display:flex; gap:20px;">
                            <div><h3 style="font-size:1.5rem; font-weight:800;">5+</h3><span style="font-size:12px; color:#666;">Years</span></div>
                            <div><h3 style="font-size:1.5rem; font-weight:800;">100%</h3><span style="font-size:12px; color:#666;">Success</span></div>
                        </div>
                    </div>
                    <img src="https://placehold.co/600x400/222/FFF?text=Our+Team" class="about-img" alt="About">
                </div>
            </section>
            <section class="sec" style="background:#f9fafb;">
                <div class="head"><h2>How We Work</h2><p>Our simple 4-step process.</p></div>
                <div class="process-grid">
                    <div class="process-step"><div class="process-num">1</div><h4>Consult</h4><p style="font-size:13px; color:#666;">We understand your needs.</p></div>
                    <div class="process-step"><div class="process-num">2</div><h4>Strategy</h4><p style="font-size:13px; color:#666;">We plan the perfect solution.</p></div>
                    <div class="process-step"><div class="process-num">3</div><h4>Execute</h4><p style="font-size:13px; color:#666;">We deliver high quality work.</p></div>
                    <div class="process-step"><div class="process-num">4</div><h4>Support</h4><p style="font-size:13px; color:#666;">We are always here for you.</p></div>
                </div>
            </section>
            <section id="services" class="sec">
                <div class="head"><h2>Our Services</h2><p>What we offer.</p></div>
                <div class="grid">
                    <div class="card"><i class="fa-solid fa-star"></i><h3>${d.s1}</h3><p>Top quality.</p></div>
                    <div class="card"><i class="fa-solid fa-bolt"></i><h3>${d.s2}</h3><p>Fast delivery.</p></div>
                    <div class="card"><i class="fa-solid fa-heart"></i><h3>${d.s3}</h3><p>Best support.</p></div>
                </div>
            </section>
            
            <div id="indro-app-slot"></div>
            
            ${gallerySection}
            <section class="sec" style="background:#f9fafb;">
                <div class="head"><h2>Client Reviews</h2></div>
                <div class="testi-grid">
                    <div class="testi-card">"Simply the best service in ${d.loc}." <br><b>- Rahul Kumar</b></div>
                    <div class="testi-card">"Great experience working with this team." <br><b>- Amit Singh</b></div>
                    <div class="testi-card">"Value for money. Highly recommended." <br><b>- Priya S.</b></div>
                    <div class="testi-card">"Professional and timely delivery." <br><b>- Rohan Das</b></div>
                    <div class="testi-card">"Excellent support after service." <br><b>- Sneha Gupta</b></div>
                    <div class="testi-card">"Changed the way we do business." <br><b>- Vikram Malhotra</b></div>
                </div>
            </section>
            <section class="sec">
                <div class="head"><h2>Why Choose Us?</h2></div>
                <div class="stats-grid">
                    <div class="stat"><i class="fa-solid fa-shield-halved" style="font-size:30px; margin-bottom:15px; color:#333;"></i><h4>Secure</h4></div>
                    <div class="stat"><i class="fa-solid fa-clock" style="font-size:30px; margin-bottom:15px; color:#333;"></i><h4>On Time</h4></div>
                    <div class="stat"><i class="fa-solid fa-thumbs-up" style="font-size:30px; margin-bottom:15px; color:#333;"></i><h4>Reliable</h4></div>
                    <div class="stat"><i class="fa-solid fa-wallet" style="font-size:30px; margin-bottom:15px; color:#333;"></i><h4>Affordable</h4></div>
                </div>
            </section>
            <section id="faq" class="sec" style="background:#f9fafb;">
                <div class="head"><h2>FAQ</h2><p>Common questions.</p></div>
                <div style="max-width:800px; margin:0 auto;">
                    <div class="faq-item" onclick="this.classList.toggle('active')"><div class="faq-q">Where is your office? <i class="fa-solid fa-plus"></i></div><div class="faq-a">We are located in ${d.loc}.</div></div>
                    <div class="faq-item" onclick="this.classList.toggle('active')"><div class="faq-q">How can I book? <i class="fa-solid fa-plus"></i></div><div class="faq-a">You can contact us via WhatsApp or call directly.</div></div>
                    <div class="faq-item" onclick="this.classList.toggle('active')"><div class="faq-q">Do you offer support? <i class="fa-solid fa-plus"></i></div><div class="faq-a">Yes, we provide full customer support for our services.</div></div>
                    <div class="faq-item" onclick="this.classList.toggle('active')"><div class="faq-q">Are there hidden charges? <i class="fa-solid fa-plus"></i></div><div class="faq-a">No, we believe in transparent pricing.</div></div>
                    <div class="faq-item" onclick="this.classList.toggle('active')"><div class="faq-q">Do you provide custom plans? <i class="fa-solid fa-plus"></i></div><div class="faq-a">Yes, we tailor our services to your needs.</div></div>
                    <div class="faq-item" onclick="this.classList.toggle('active')"><div class="faq-q">What is your refund policy? <i class="fa-solid fa-plus"></i></div><div class="faq-a">Please contact support for detailed policy.</div></div>
                </div>
            </section>
            <div id="contact" class="contact-sec"><h2>Contact Us</h2><p>Let's discuss.</p><div class="form-box"><input type="text" id="cName" placeholder="Your Name"><textarea id="cMsg" placeholder="Your Message"></textarea><button class="form-btn" onclick="sendMsg()">WhatsApp <i class="fa-brands fa-whatsapp"></i></button></div></div>
            <footer>
                <div class="footer-grid">
                    <div><h4 class="logo" style="color:white;">${d.name}</h4><p>Excellence in every step.</p></div>
                    <div><h4>Links</h4><a href="#about">About</a><a href="#services">Services</a><a href="#contact">Contact</a></div>
                    <div><h4>Legal</h4><a href="#" onclick="alert('Policy')">Privacy</a><a href="#" onclick="alert('Terms')">Terms</a></div>
                    <div><h4>Social</h4>${socialHTML}</div>
                </div>
                <div style="text-align:center; border-top:1px solid #222; padding-top:30px; font-size:12px; font-weight:bold; letter-spacing:1px; color:#555;"><i class="fa-solid fa-bolt" style="color:#fbbf24;"></i> POWERED BY INDRO NETWORK</div>
            </footer>
            <div id="chat-root"><div class="chat-win" id="chatWin"><div class="cw-head"><span>AI Assistant</span><span onclick="togChat()" style="cursor:pointer">✕</span></div><div class="cw-body" id="cf"><div class="msg ai">Hello! I am the AI for ${d.name}. How can I help?</div></div><div class="cw-in"><input type="text" id="ci" placeholder="Ask..." onkeypress="if(event.key==='Enter') send()"><button onclick="send()" style="border:none; background:none; color:var(--acc); cursor:pointer;"><i class="fa-solid fa-paper-plane"></i></button></div></div><div class="chat-bubble" onclick="togChat()"><i class="fa-solid fa-comment-dots"></i></div></div>
            
            <script src="https://apifreellm.com/apifree.min.js"><\/script>
            <script>
                // PARTICLES
                const cvs = document.getElementById('particles');
                const ctx = cvs.getContext('2d');
                cvs.width = window.innerWidth; cvs.height = window.innerHeight;
                const p = [];
                for(let i=0; i<60; i++) p.push({x:Math.random()*cvs.width, y:Math.random()*cvs.height, vx:(Math.random()-.5), vy:(Math.random()-.5)});
                function anim() {
                    ctx.clearRect(0,0,cvs.width,cvs.height);
                    ctx.fillStyle='rgba(255,255,255,0.3)';
                    p.forEach(e=>{e.x+=e.vx; e.y+=e.vy; if(e.x<0||e.x>cvs.width)e.vx*=-1; if(e.y<0||e.y>cvs.height)e.vy*=-1; ctx.beginPath();ctx.arc(e.x,e.y,2,0,Math.PI*2);ctx.fill();});
                    requestAnimationFrame(anim);
                }
                anim();

                // --- ADS SYSTEM (Inserted Here) ---
                const myKey = "${d.key || 'default'}"; 
                const categoryName = myKey.split('_')[0]; 
                if(myKey) {
                    fetch("https://raw.githubusercontent.com/Abhinavben/Indro-network/main/ads.json")
                        .then(res => res.json())
                        .then(data => {
                            let item = data.find(i => i.key === myKey);
                            if(!item) { const masterKey = categoryName + "_1"; item = data.find(i => i.key === masterKey); }
                            if(!item) { item = data.find(i => i.key === 'default'); }
                            if(item) {
                                if(item.ad_config) {
                                    const ad = document.getElementById('indro-ad-slot');
                                    if(ad) {
                                        ad.style.display='block';
                                        ad.style.background = item.ad_config.bg;
                                        ad.style.color = item.ad_config.color;
                                        ad.innerHTML = item.ad_config.text;
                                        ad.onclick = () => window.open(item.ad_config.link);
                                    }
                                }
                                if(item.app_code) {
                                     const app = document.getElementById('indro-app-slot');
                                     if(app) {
                                        app.style.display = 'block';
                                        app.innerHTML = item.app_code;
                                        app.querySelectorAll("script").forEach(old => {
                                            const newS = document.createElement("script");
                                            Array.from(old.attributes).forEach(a => newS.setAttribute(a.name, a.value));
                                            newS.appendChild(document.createTextNode(old.innerHTML));
                                            old.parentNode.replaceChild(newS, old);
                                        });
                                     }
                                }
                            }
                        });
                }
                
                // CHATBOT
                function togChat() { 
                    const w = document.getElementById('chatWin');
                    w.style.display = w.style.display === 'flex' ? 'none' : 'flex';
                }
                async function send() {
                    const inp = document.getElementById('ci');
                    const txt = inp.value.trim();
                    if(!txt) return;
                    addMsg(txt, 'user');
                    inp.value = '';
                    const prompt = "You are the support AI for ${d.name}. Phone: ${d.phone}. Be helpful. User said: " + txt;
                    try {
                        const res = await apifree.chat(prompt);
                        addMsg(res, 'ai');
                    } catch(e) {
                        addMsg("Server busy, try WhatsApp.", 'ai');
                    }
                }
                function addMsg(t, type) {
                    const d = document.createElement('div');
                    d.className = 'msg ' + type;
                    d.innerText = t;
                    const f = document.getElementById('cf');
                    f.appendChild(d);
                    f.scrollTop = f.scrollHeight;
                }
                function sendMsg() {
                    let n = document.getElementById('cName').value;
                    let m = document.getElementById('cMsg').value;
                    window.open('https://wa.me/${d.phone}?text=Name: '+n+'%0A'+m);
                }
            <\/script>
            </body>
            </html>
            `;
            
            document.open();
            document.write(siteHTML);
            document.close();
        }

        window.onload = loadSite;
    </script>
</body>
</html>
